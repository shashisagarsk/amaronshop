{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///D:/2025%20Project/amaron/app/cart/page.jsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { useRouter } from \"next/navigation\"\r\nimport Image from \"next/image\"\r\nimport { Minus, Plus, Trash2 } from \"lucide-react\"\r\nimport { jwtDecode } from \"jwt-decode\"\r\n\r\n\r\nexport default function CartPage() {\r\n  const [cartItems, setCartItems] = useState([])\r\n  const [isLoggedIn, setIsLoggedIn] = useState(false)\r\n  const [showOrderHistoryBtn, setShowOrderHistoryBtn] = useState(false)\r\n  const router = useRouter()\r\n\r\n  const getUser = () => {\r\n    const token = localStorage.getItem(\"token\")\r\n    if (token) {\r\n      try {\r\n        return jwtDecode(token)\r\n      } catch {}\r\n    }\r\n    const userStr = localStorage.getItem(\"user\")\r\n    if (!userStr) return null\r\n    try {\r\n      return JSON.parse(userStr)\r\n    } catch {\r\n      return null\r\n    }\r\n  }\r\n\r\n  const getCartKey = (user) => {\r\n    if (user && (user.id || user.userId)) return `cart_${user.id || user.userId}`\r\n    if (user && user.email) return `cart_${user.email}`\r\n    return \"cart_guest\"\r\n  }\r\n\r\n  const loadCartAndUser = () => {\r\n    const user = getUser()\r\n    setIsLoggedIn(!!user)\r\n    const cartKey = getCartKey(user)\r\n    const cart = JSON.parse(localStorage.getItem(cartKey) || \"[]\")\r\n    setCartItems(cart)\r\n  }\r\n\r\n  useEffect(() => {\r\n    loadCartAndUser()\r\n\r\n    const handleStorageChange = () => {\r\n      loadCartAndUser()\r\n    }\r\n    window.addEventListener(\"storage\", handleStorageChange)\r\n    window.addEventListener(\"logout\", handleStorageChange) // Listen for logout too\r\n\r\n    return () => {\r\n      window.removeEventListener(\"storage\", handleStorageChange)\r\n      window.removeEventListener(\"logout\", handleStorageChange)\r\n    }\r\n  }, [])\r\n\r\n  const saveCart = (updatedCart) => {\r\n    const user = getUser()\r\n    const cartKey = getCartKey(user)\r\n    localStorage.setItem(cartKey, JSON.stringify(updatedCart))\r\n    window.dispatchEvent(new Event(\"storage\")) // Notify other components like Header\r\n  }\r\n\r\n  const updateQuantity = (id, newQuantity) => {\r\n    if (newQuantity < 1) {\r\n      removeItem(id)\r\n      return\r\n    }\r\n    const updatedCart = cartItems.map((item) => (item.id === id ? { ...item, quantity: newQuantity } : item))\r\n    setCartItems(updatedCart)\r\n    saveCart(updatedCart)\r\n  }\r\n\r\n  const removeItem = (id) => {\r\n    const updatedCart = cartItems.filter((item) => item.id !== id)\r\n    setCartItems(updatedCart)\r\n    saveCart(updatedCart)\r\n  }\r\n\r\n  const getTotalPrice = () => {\r\n    return cartItems.reduce((total, item) => total + item.price * item.quantity, 0).toFixed(2)\r\n  }\r\n\r\n  const handleBuy = () => {\r\n    if (!isLoggedIn) {\r\n      router.push(\"/login\")\r\n      return\r\n    }\r\n\r\n    alert(\"Purchase successful! Thank you for your order.\")\r\n    const user = getUser()\r\n    const cartKey = getCartKey(user)\r\n    const ordersKey = user && (user.id || user.userId || user.email) ? `orders_${user.id || user.userId || user.email}` : null\r\n    \r\n    if (ordersKey) {\r\n      const prevOrders = JSON.parse(localStorage.getItem(ordersKey) || \"[]\")\r\n      prevOrders.push({\r\n        orderId: `order_${Date.now()}`,\r\n        date: new Date().toISOString(),\r\n        items: cartItems,\r\n        total: getTotalPrice(),\r\n      })\r\n      localStorage.setItem(ordersKey, JSON.stringify(prevOrders))\r\n    }\r\n\r\n    localStorage.removeItem(cartKey)\r\n    setCartItems([])\r\n    setShowOrderHistoryBtn(true)\r\n    window.dispatchEvent(new Event(\"storage\")) // Notify Header to update cart count\r\n  }\r\n\r\n  if (cartItems.length === 0) {\r\n    return (\r\n      <div className=\"flex flex-col min-h-screen bg-gray-50\">\r\n    \r\n        <main className=\"flex-grow container mx-auto px-4 py-16 text-center\">\r\n          <h1 className=\"text-3xl font-bold mb-8\">Your Cart is Empty</h1>\r\n          <p className=\"text-gray-600 mb-8\">Add some products to your cart to get started!</p>\r\n          <button\r\n            onClick={() => router.push(\"/\")}\r\n            className=\"bg-blue-600 text-white font-semibold py-2 px-6 rounded-md hover:bg-blue-700 transition\"\r\n          >\r\n            Continue Shopping\r\n          </button>\r\n          {showOrderHistoryBtn && (\r\n            <div className=\"mt-6\">\r\n              <button\r\n                onClick={() => router.push(\"/orders\")}\r\n                className=\"bg-gray-800 text-white font-semibold py-2 px-6 rounded-md hover:bg-gray-900 transition\"\r\n              >\r\n                View Order History\r\n              </button>\r\n            </div>\r\n          )}\r\n        </main>\r\n        <Footer />\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex flex-col min-h-screen bg-gray-50\">\r\n      <Header />\r\n      <main className=\"flex-grow container mx-auto px-4 py-8\">\r\n        <h1 className=\"text-3xl font-bold mb-8\">Shopping Cart</h1>\r\n\r\n        <div className=\"grid lg:grid-cols-3 gap-8\">\r\n          <div className=\"lg:col-span-2 space-y-4\">\r\n            {cartItems.map((item) => (\r\n              <div key={item.id} className=\"bg-white border rounded-lg shadow-sm\">\r\n                <div className=\"p-4 sm:p-6\">\r\n                  <div className=\"flex flex-col sm:flex-row items-center space-y-4 sm:space-y-0 sm:space-x-4\">\r\n                    <Image\r\n                      src={item.image || \"/placeholder.svg\"}\r\n                      alt={item.name}\r\n                      width={80}\r\n                      height={80}\r\n                      className=\"rounded-lg object-cover\"\r\n                    />\r\n\r\n                    <div className=\"flex-1 text-center sm:text-left\">\r\n                      <h3 className=\"text-lg font-semibold\">{item.name}</h3>\r\n                      <p className=\"text-blue-600 font-bold\">${item.price.toFixed(2)}</p>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      <button\r\n                        onClick={() => updateQuantity(item.id, item.quantity - 1)}\r\n                        className=\"p-2 border rounded-md hover:bg-gray-100\"\r\n                      >\r\n                        <Minus className=\"h-4 w-4\" />\r\n                      </button>\r\n                      <span className=\"w-8 text-center font-semibold\">{item.quantity}</span>\r\n                      <button\r\n                        onClick={() => updateQuantity(item.id, item.quantity + 1)}\r\n                        className=\"p-2 border rounded-md hover:bg-gray-100\"\r\n                      >\r\n                        <Plus className=\"h-4 w-4\" />\r\n                      </button>\r\n                    </div>\r\n\r\n                    <div className=\"text-center sm:text-right\">\r\n                      <p className=\"font-bold text-lg\">${(item.price * item.quantity).toFixed(2)}</p>\r\n                    </div>\r\n                    \r\n                    <button\r\n                      onClick={() => removeItem(item.id)}\r\n                      className=\"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-full\"\r\n                    >\r\n                      <Trash2 className=\"h-4 w-4\" />\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          <div>\r\n            <div className=\"bg-white border rounded-lg shadow-sm\">\r\n              <div className=\"p-6\">\r\n                <h2 className=\"text-xl font-bold mb-4\">Order Summary</h2>\r\n                <div className=\"space-y-2 mb-4\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Subtotal:</span>\r\n                    <span>${getTotalPrice()}</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Shipping:</span>\r\n                    <span>Free</span>\r\n                  </div>\r\n                  <div className=\"border-t pt-2 mt-2\">\r\n                    <div className=\"flex justify-between font-bold text-lg\">\r\n                      <span>Total:</span>\r\n                      <span>${getTotalPrice()}</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <button\r\n                  onClick={handleBuy}\r\n                  className=\"w-full bg-blue-600 text-white font-semibold py-3 px-6 rounded-md hover:bg-blue-700 transition text-lg\"\r\n                >\r\n                  {isLoggedIn ? \"Buy Now\" : \"Login to Buy\"}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </main>\r\n   \r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}